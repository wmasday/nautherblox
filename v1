--// Player GUI Setup
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

if playerGui:FindFirstChild("WickingMOD") then
	playerGui:FindFirstChild("WickingMOD"):Destroy()
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "WickingMOD"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

--// Toggle Button
local visibilityToggle = Instance.new("TextButton")
visibilityToggle.Name = "VisibilityToggle"
visibilityToggle.Size = UDim2.new(0, 40, 0, 40)
visibilityToggle.Position = UDim2.new(0.5, 120, 0.5, -230)
visibilityToggle.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
visibilityToggle.BackgroundTransparency = 0.2
visibilityToggle.BorderSizePixel = 0
visibilityToggle.Text = "âš™ï¸"
visibilityToggle.Font = Enum.Font.GothamBold
visibilityToggle.TextSize = 20
visibilityToggle.TextColor3 = Color3.fromRGB(200, 200, 200)
visibilityToggle.Parent = screenGui
Instance.new("UICorner", visibilityToggle).CornerRadius = UDim.new(0, 10)

--// Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 300, 0, 400)
mainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(240, 240, 255)
mainFrame.BackgroundTransparency = 0.25
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 15)

-- Shadow
local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.Size = UDim2.new(1, 20, 1, 20)
shadow.Position = UDim2.new(0, -10, 0, -10)
shadow.Image = "rbxassetid://1316045217"
shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
shadow.ImageTransparency = 0.85
shadow.ScaleType = Enum.ScaleType.Slice
shadow.SliceCenter = Rect.new(10, 10, 118, 118)
shadow.ZIndex = 0
shadow.BackgroundTransparency = 1
shadow.Parent = mainFrame

-- Content Container
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -20, 1, -20)
contentFrame.Position = UDim2.new(0, 10, 0, 10)
contentFrame.BackgroundTransparency = 1
contentFrame.ZIndex = 2
contentFrame.Parent = mainFrame

local layout = Instance.new("UIListLayout", contentFrame)
layout.Padding = UDim.new(0, 10)
layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
layout.VerticalAlignment = Enum.VerticalAlignment.Top
layout.SortOrder = Enum.SortOrder.LayoutOrder

local padding = Instance.new("UIPadding", contentFrame)
padding.PaddingTop = UDim.new(0, 10)

--// Title Label
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Text = "ðŸŽ£ WickingMOD"
title.TextColor3 = Color3.fromRGB(25, 25, 25)
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.LayoutOrder = 1
title.Parent = contentFrame

-- Helper: create input row
local function createInput(labelText, placeholder)
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(1, 0, 0, 35)
	frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	frame.BackgroundTransparency = 0.15
	frame.BorderSizePixel = 0
	frame.LayoutOrder = 2
	frame.Parent = contentFrame
	Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(0.6, 0, 1, 0)
	label.BackgroundTransparency = 1
	label.Text = labelText
	label.Font = Enum.Font.SourceSansBold
	label.TextColor3 = Color3.fromRGB(40, 40, 40)
	label.TextSize = 14
	label.TextXAlignment = Enum.TextXAlignment.Left
	label.Position = UDim2.new(0, 10, 0, 0)

	local input = Instance.new("TextBox", frame)
	input.Size = UDim2.new(0.35, 0, 0.8, 0)
	input.Position = UDim2.new(0.6, 0, 0.1, 0)
	input.BackgroundTransparency = 1
	input.TextColor3 = Color3.fromRGB(0, 140, 255)
	input.PlaceholderText = placeholder
	input.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
	input.Font = Enum.Font.SourceSans
	input.TextSize = 14
	input.TextXAlignment = Enum.TextXAlignment.Right
	input.ClearTextOnFocus = false

	return input
end

local chargeInput = createInput("Wait After Charge (s)", "0.1")
local miniInput = createInput("Wait After Minigame (s)", "1.3")
local betweenInput = createInput("Wait Between Cycles (s)", "0.1")
local loopInput = createInput("Cycle Limit", "inf")

--// Infinite Loop Toggle
local toggleInfinite = Instance.new("TextButton")
toggleInfinite.Size = UDim2.new(1, 0, 0, 35)
toggleInfinite.Text = "INFINITE LOOP: ON"
toggleInfinite.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleInfinite.Font = Enum.Font.SourceSansBold
toggleInfinite.TextSize = 14
toggleInfinite.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
Instance.new("UICorner", toggleInfinite).CornerRadius = UDim.new(0, 8)
toggleInfinite.LayoutOrder = 8
toggleInfinite.Parent = contentFrame

local infiniteLoop = true
toggleInfinite.MouseButton1Click:Connect(function()
	infiniteLoop = not infiniteLoop
	toggleInfinite.Text = infiniteLoop and "INFINITE LOOP: ON" or "LIMITED LOOP: OFF"
	toggleInfinite.BackgroundColor3 = infiniteLoop and Color3.fromRGB(0, 150, 255) or Color3.fromRGB(255, 100, 0)
	loopInput.Text = infiniteLoop and "inf" or (loopInput.Text == "inf" and "1" or loopInput.Text)
end)

--// Button Container
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(1, 0, 0, 40)
buttonContainer.BackgroundTransparency = 1
buttonContainer.LayoutOrder = 9
buttonContainer.Parent = contentFrame

local hLayout = Instance.new("UIListLayout", buttonContainer)
hLayout.FillDirection = Enum.FillDirection.Horizontal
hLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
hLayout.Padding = UDim.new(0, 8)

local function makeButton(text, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.33, -5.33, 1, 0)
	btn.Text = text
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 14
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.BackgroundColor3 = color
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
	btn.Parent = buttonContainer
	return btn
end

local startButton = makeButton("START", Color3.fromRGB(0, 168, 87))
local stopButton = makeButton("STOP", Color3.fromRGB(230, 74, 25))
local resetButton = makeButton("RESET", Color3.fromRGB(66, 133, 244))

--// Visibility Toggle Logic
local menuVisible = true
mainFrame.Visible = true

visibilityToggle.MouseButton1Click:Connect(function()
	menuVisible = not menuVisible
	mainFrame.Visible = menuVisible
	visibilityToggle.Text = menuVisible and "âŒ" or "âš™ï¸"
end)

--// Drag System (only when hidden)
local dragging = false
local dragStart, startPos

visibilityToggle.InputBegan:Connect(function(input)
	if not menuVisible and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
		dragging = true
		dragStart = input.Position
		startPos = visibilityToggle.Position
	end
end)

visibilityToggle.InputChanged:Connect(function(input)
	if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		local delta = input.Position - dragStart
		visibilityToggle.Position = UDim2.new(
			startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y
		)
	end
end)

game:GetService("UserInputService").InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = false
	end
end)

--// Fishing Logic
local net = game:GetService("ReplicatedStorage")
	:WaitForChild("Packages")
	:WaitForChild("_Index")
	:WaitForChild("sleitnick_net@0.2.0")
	:WaitForChild("net")

local running = false
local argsList = { { -31.98394012451172, 0.5, 1762885213.773613 } }

local function startFishing()
	if running then return end
	running = true
	startButton.Text = "RUNNING..."
	startButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

	-- ðŸ§  Disable all local fishing scripts in character and tool
	local player = game.Players.LocalPlayer
	local character = player.Character or player.CharacterAdded:Wait()

	for _, obj in ipairs(character:GetDescendants()) do
		if obj:IsA("LocalScript") and string.find(obj.Name:lower(), "fish") then
			obj.Disabled = true
		end
	end

	local rod = character:FindFirstChildOfClass("Tool")
	if rod then
		for _, obj in ipairs(rod:GetDescendants()) do
			if obj:IsA("LocalScript") and string.find(obj.Name:lower(), "fish") then
				obj.Disabled = true
			end
		end
	end

	-- Continue with your main loop
	local WAIT_AFTER_CHARGE = tonumber(chargeInput.Text) or 0.1
	local WAIT_AFTER_MINIGAME = tonumber(miniInput.Text) or 1.3
	local WAIT_BETWEEN_CYCLES = tonumber(betweenInput.Text) or 0.1
	local maxCycles = infiniteLoop and math.huge or tonumber(loopInput.Text) or 1

	while running do
		for i = 1, maxCycles do
			if not running then break end
			local args = argsList[1]
			net:WaitForChild("RF/ChargeFishingRod"):InvokeServer()
			task.wait(WAIT_AFTER_CHARGE)
			net:WaitForChild("RF/RequestFishingMinigameStarted"):InvokeServer(unpack(args))
			task.wait(WAIT_AFTER_MINIGAME)
			net:WaitForChild("RE/FishingCompleted"):FireServer()
			task.wait(WAIT_BETWEEN_CYCLES)
			if not infiniteLoop and i >= maxCycles then
				running = false
				break
			end
		end
	end

	startButton.Text = "START"
	startButton.BackgroundColor3 = Color3.fromRGB(0, 168, 87)
	running = false
end


local function stopFishing()
	running = false
	startButton.Text = "START"
	startButton.BackgroundColor3 = Color3.fromRGB(0, 168, 87)
end

local function resetAll()
	stopFishing()
	chargeInput.Text = "0.1"
	miniInput.Text = "1.3"
	betweenInput.Text = "0.1"
	loopInput.Text = "inf"
	infiniteLoop = true
	toggleInfinite.Text = "INFINITE LOOP: ON"
	toggleInfinite.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
end

resetAll()
startButton.MouseButton1Click:Connect(startFishing)
stopButton.MouseButton1Click:Connect(stopFishing)
resetButton.MouseButton1Click:Connect(resetAll)
